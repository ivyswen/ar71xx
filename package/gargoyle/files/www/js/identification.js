/*
 * This program is copyright ï¿½ 2008-2011 Eric Bishop and is distributed under the terms of the GNU GPL 
 * version 2.0 with a special clarification/exception that permits adapting the program to 
 * configure proprietary "back end" software provided that all modifications to the web interface
 * itself remain covered by the GPL. 
 * See http://gargoyle-router.com/faq.html#qfoss for more information
 */function saveChanges(){errorList=proofreadAll();if(errorList.length>0)errorString=errorList.join("\n")+"\n\nChanges could not be applied.",alert(errorString);else{setControlsEnabled(!1,!0);var e=uciOriginal.getAllSectionsOfType("system","system"),t=uciOriginal.getAllSectionsOfType("dhcp","dnsmasq"),n=uciOriginal.clone(),r=document.getElementById("hostname").value,i=document.getElementById("domain").value;n.set("system",e[0],"hostname",r),isBridge(uciOriginal)||n.set("dhcp",t[0],"domain",i);var s=document.getElementById("garg_host");s.replaceChild(document.createTextNode("Device Name: "+r),s.firstChild);var o=n.getScriptCommands(uciOriginal)+'\necho "'+r+'" > /proc/sys/kernel/hostname \n'+(havePrinterScript?"\nsh /usr/lib/gargoyle/configure_printer.sh\n":""),u=getParameterDefinition("commands",o)+"&"+getParameterDefinition("hash",document.cookie.replace(/^.*hash=/,"").replace(/[\t ;]+.*$/,"")),a=function(e){e.readyState==4&&(uciOriginal=n.clone(),resetData(),setControlsEnabled(!0),window.location.href=window.location.href)};runAjax("POST","utility/run_commands.sh",u,a)}}function proofreadAll(){var e=function(e){return validateLengthRange(e,1,999)},t;return isBridge(uciOriginal)?t=proofreadFields(["hostname"],["hostname_label"],[e],[0],["hostname"]):t=proofreadFields(["hostname","domain"],["hostname_label","domain_label"],[e,e],[0,0],["hostname","domain"]),t}function resetData(){var e=uciOriginal.getAllSectionsOfType("system","system"),t=uciOriginal.getAllSectionsOfType("dhcp","dnsmasq"),n=uciOriginal.get("system",e[0],"hostname"),r=uciOriginal.get("dhcp",t[0],"domain");document.getElementById("hostname").value=n,document.getElementById("domain").value=r,isBridge(uciOriginal)&&(document.getElementById("domain_container").style.display="none")};