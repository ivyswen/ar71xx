/*
 * This program is copyright ï¿½ 2008 Eric Bishop and is distributed under the terms of the GNU GPL 
 * version 2.0 with a special clarification/exception that permits adapting the program to 
 * configure proprietary "back end" software provided that all modifications to the web interface
 * itself remain covered by the GPL. 
 * See http://gargoyle-router.com/faq.html#qfoss for more information
 */function getBackup(){setControlsEnabled(!1,!0,"Preparing Backup File");var e=getParameterDefinition("commands","sh /usr/lib/gargoyle/create_backup.sh ;\n")+"&"+getParameterDefinition("hash",document.cookie.replace(/^.*hash=/,"").replace(/[\t ;]+.*$/,"")),t=function(e){e.readyState==4&&(setControlsEnabled(!0),window.location="/dump_backup_tarball.sh")};runAjax("POST","utility/run_commands.sh",e,t)}function doRestore(){document.getElementById("restore_file").value.length==0?alert("ERROR: You must select a configuration file to restore from."):(confirmRestore=window.confirm("This will completely erase your current settings and replace them with new ones from the selected configuration file.  Are you sure you want to continue?"),confirmRestore&&(document.getElementById("restore_hash").value=document.cookie.replace(/^.*hash=/,"").replace(/[\t ;]+.*$/,""),document.getElementById("restore_form").submit(),setControlsEnabled(!1,!0,"Uploading Configuration File")))}function doDefaultRestore(){var e=window.confirm("This will completely erase your current settings and replace them with the original, default settings.  Are you sure you want to continue?");e&&(document.getElementById("restore_original_hash").value=document.cookie.replace(/^.*hash=/,"").replace(/[\t ;]+.*$/,""),document.getElementById("restore_original_form").submit(),setControlsEnabled(!1,!0,"Loading Original Configuration File"))}function restoreFailed(){setControlsEnabled(!0),alert("Restore failed.  Ensure that uploaded file is a valid Gargoyle configuration file and try again.")}function restoreSuccessful(e){setControlsEnabled(!1,!0,"Please wait while new settings are applied"),globalLanIp=e;var t=getParameterDefinition("commands","sh /usr/lib/gargoyle/reboot.sh ;\n")+"&"+getParameterDefinition("hash",document.cookie.replace(/^.*hash=/,"").replace(/[\t ;]+.*$/,"")),n=function(e){return 0};runAjax("POST","utility/run_commands.sh",t,n),currentProtocol=location.href.match(/^https:/)?"https":"http",testLocation=currentProtocol+"://"+globalLanIp+":"+window.location.port+"/utility/reboot_test.sh",testReboot=function(){toggleReload=!0,setTimeout("testReboot()",5e3),document.getElementById("reboot_test").src=testLocation},setTimeout("testReboot()",25e3),setTimeout("reloadPage()",24e4)}function reloadPage(){if(toggleReload){var e=document.getElementById("reboot_test").readyState;if(typeof e=="undefined"||e==null||e=="complete")toggleReload=!1,document.getElementById("reboot_test").src="",currentProtocol=location.href.match(/^https:/)?"https":"http",window.location=currentProtocol+"://"+globalLanIp+":"+window.location.port+window.location.pathname}}var toggleReload=!1,globalLanIp;